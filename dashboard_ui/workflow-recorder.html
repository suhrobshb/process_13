<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Engine - Workflow Recorder & Editor</title>
    <style>
        :root {
            --primary: #3498db;
            --primary-dark: #2980b9;
            --secondary: #2ecc71;
            --secondary-dark: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #34495e;
            --gray: #95a5a6;
            --white: #ffffff;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --border-radius: 4px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .header {
            background-color: var(--dark);
            color: var(--white);
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            z-index: 100;
        }

        .header h1 {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
        }

        .header h1 svg {
            margin-right: 0.5rem;
        }

        .header-controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }

        .btn svg {
            width: 16px;
            height: 16px;
        }

        .btn-primary {
            background-color: var(--primary);
            color: var(--white);
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
        }

        .btn-success {
            background-color: var(--secondary);
            color: var(--white);
        }

        .btn-success:hover {
            background-color: var(--secondary-dark);
        }

        .btn-danger {
            background-color: var(--danger);
            color: var(--white);
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-light {
            background-color: var(--light);
            color: var(--dark);
        }

        .btn-light:hover {
            background-color: #bdc3c7;
        }

        .recording-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-weight: 500;
            color: var(--white);
            padding: 0.5rem;
            border-radius: var(--border-radius);
            background-color: rgba(0, 0, 0, 0.2);
        }

        .recording-indicator.active {
            background-color: rgba(231, 76, 60, 0.2);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
            100% {
                opacity: 1;
            }
        }

        .recording-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--gray);
        }

        .recording-dot.active {
            background-color: var(--danger);
        }

        .main-container {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: var(--white);
            border-right: 1px solid #e1e4e8;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid #e1e4e8;
        }

        .sidebar-tab {
            flex: 1;
            padding: 0.75rem;
            text-align: center;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .sidebar-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
        }

        .sidebar-tab:hover:not(.active) {
            background-color: #f5f7fa;
        }

        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .component-group {
            margin-bottom: 1.5rem;
        }

        .component-group-title {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--gray);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .component-list {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .component-item {
            padding: 0.75rem;
            background-color: var(--light);
            border-radius: var(--border-radius);
            cursor: grab;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
            user-select: none;
        }

        .component-item:hover {
            background-color: #e0e6eb;
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .component-item.action {
            border-left: 3px solid var(--primary);
        }

        .component-item.decision {
            border-left: 3px solid var(--warning);
        }

        .component-item.approval {
            border-left: 3px solid var(--secondary);
        }

        .component-item.trigger {
            border-left: 3px solid var(--danger);
        }

        .component-item svg {
            width: 18px;
            height: 18px;
        }

        .component-item-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 6px;
        }

        .component-item-icon.action {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--primary);
        }

        .component-item-icon.decision {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .component-item-icon.approval {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--secondary);
        }

        .component-item-icon.trigger {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .component-item-content {
            flex: 1;
        }

        .component-item-title {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .component-item-description {
            font-size: 0.8rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }

        .workspace {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .workspace-toolbar {
            padding: 0.5rem;
            background-color: var(--white);
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            gap: 0.5rem;
        }

        .workspace-canvas {
            flex: 1;
            background-color: #f8f9fa;
            background-image: 
                linear-gradient(rgba(0, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
            position: relative;
            overflow: auto;
        }

        .canvas-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 3000px;
            height: 3000px;
            transform-origin: 0 0;
        }

        .node {
            position: absolute;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: var(--shadow);
            width: 200px;
            padding: 1rem;
            cursor: move;
            user-select: none;
            z-index: 10;
        }

        .node.action {
            border-top: 4px solid var(--primary);
        }

        .node.decision {
            border-top: 4px solid var(--warning);
        }

        .node.approval {
            border-top: 4px solid var(--secondary);
        }

        .node.trigger {
            border-top: 4px solid var(--danger);
        }

        .node-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .node-title {
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .node-actions {
            display: flex;
            gap: 0.25rem;
        }

        .node-action-btn {
            width: 24px;
            height: 24px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: transparent;
            border: none;
            cursor: pointer;
            color: var(--gray);
            transition: all 0.2s ease;
        }

        .node-action-btn:hover {
            background-color: #f5f7fa;
            color: var(--dark);
        }

        .node-content {
            font-size: 0.85rem;
            color: var(--dark);
        }

        .node-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 0.75rem;
            font-size: 0.75rem;
            color: var(--gray);
        }

        .node-id {
            font-family: monospace;
        }

        .connection-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: var(--white);
            border: 2px solid var(--primary);
            border-radius: 50%;
            z-index: 20;
            cursor: crosshair;
        }

        .connection-point.input {
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
        }

        .connection-point.output {
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
        }

        .connection-point.decision-true {
            bottom: -6px;
            left: 25%;
            transform: translateX(-50%);
            border-color: var(--secondary);
        }

        .connection-point.decision-false {
            bottom: -6px;
            left: 75%;
            transform: translateX(-50%);
            border-color: var(--danger);
        }

        .connection {
            position: absolute;
            z-index: 5;
            pointer-events: none;
        }

        .connection path {
            fill: none;
            stroke: #95a5a6;
            stroke-width: 2px;
        }

        .connection.active path {
            stroke: var(--primary);
            stroke-width: 3px;
        }

        .connection.true path {
            stroke: var(--secondary);
        }

        .connection.false path {
            stroke: var(--danger);
        }

        .connection-label {
            position: absolute;
            background-color: var(--white);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
            box-shadow: var(--shadow);
            pointer-events: none;
        }

        .connection-label.true {
            color: var(--secondary);
            border: 1px solid var(--secondary);
        }

        .connection-label.false {
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .properties-panel {
            width: 300px;
            background-color: var(--white);
            border-left: 1px solid #e1e4e8;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .properties-header {
            padding: 1rem;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .properties-title {
            font-weight: 600;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .properties-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .property-group {
            margin-bottom: 1.5rem;
        }

        .property-group-title {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            color: var(--gray);
            margin-bottom: 0.75rem;
        }

        .property-field {
            margin-bottom: 1rem;
        }

        .property-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .property-input {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e1e4e8;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
        }

        .property-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        .property-select {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e1e4e8;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            background-color: var(--white);
        }

        .property-textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e1e4e8;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            min-height: 100px;
            resize: vertical;
        }

        .property-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .status-bar {
            background-color: var(--dark);
            color: var(--white);
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            display: flex;
            justify-content: space-between;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal {
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            width: 500px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        .modal-overlay.active .modal {
            transform: translateY(0);
        }

        .modal-header {
            padding: 1rem;
            border-bottom: 1px solid #e1e4e8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-weight: 600;
            font-size: 1.2rem;
        }

        .modal-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--gray);
            font-size: 1.5rem;
            line-height: 1;
        }

        .modal-body {
            padding: 1rem;
        }

        .modal-footer {
            padding: 1rem;
            border-top: 1px solid #e1e4e8;
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
        }

        /* Recording preview */
        .recording-preview {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 320px;
            background-color: var(--white);
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            z-index: 900;
        }

        .recording-preview.active {
            display: block;
        }

        .recording-preview-header {
            background-color: var(--danger);
            color: var(--white);
            padding: 0.5rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .recording-preview-title {
            font-weight: 500;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .recording-preview-content {
            padding: 1rem;
        }

        .recording-preview-screen {
            width: 100%;
            height: 180px;
            background-color: #000;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .recording-preview-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 0.75rem;
        }

        .recording-time {
            font-family: monospace;
            font-size: 0.9rem;
        }

        /* Zoom controls */
        .zoom-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 0.5rem;
            background-color: var(--white);
            padding: 0.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 50;
        }

        .zoom-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--light);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .zoom-btn:hover {
            background-color: #e0e6eb;
        }

        .zoom-level {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: 500;
            width: 60px;
        }

        /* Toast notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 9999;
        }

        .toast {
            background-color: var(--white);
            color: var(--dark);
            padding: 0.75rem 1rem;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            min-width: 300px;
            max-width: 450px;
            animation: slideIn 0.3s ease, fadeOut 0.5s ease 2.5s forwards;
            position: relative;
            overflow: hidden;
        }

        .toast::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background-color: var(--primary);
            width: 100%;
            animation: shrink 3s linear forwards;
        }

        .toast.success::after {
            background-color: var(--secondary);
        }

        .toast.error::after {
            background-color: var(--danger);
        }

        .toast.warning::after {
            background-color: var(--warning);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
            }
            to {
                opacity: 0;
            }
        }

        @keyframes shrink {
            from {
                width: 100%;
            }
            to {
                width: 0%;
            }
        }

        .toast-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .toast.info .toast-icon {
            background-color: rgba(52, 152, 219, 0.2);
            color: var(--primary);
        }

        .toast.success .toast-icon {
            background-color: rgba(46, 204, 113, 0.2);
            color: var(--secondary);
        }

        .toast.error .toast-icon {
            background-color: rgba(231, 76, 60, 0.2);
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            background-color: rgba(243, 156, 18, 0.2);
            color: var(--warning);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .toast-message {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .toast-close {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--gray);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.25rem;
        }

        .toast-close:hover {
            color: var(--dark);
        }

        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .sidebar, .properties-panel {
                width: 250px;
            }
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar, .properties-panel {
                width: 100%;
                height: 300px;
            }
            
            .properties-panel {
                border-left: none;
                border-top: 1px solid #e1e4e8;
            }
        }
    </style>
</head>
<body>
    <!-- Header with recording controls -->
    <div class="header">
        <h1>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
            AI Engine Workflow Recorder
        </h1>
        <div class="header-controls">
            <div class="recording-indicator" id="recordingIndicator">
                <div class="recording-dot" id="recordingDot"></div>
                <span id="recordingStatus">Not Recording</span>
            </div>
            <button class="btn btn-primary" id="recordBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
                Start Recording
            </button>
            <button class="btn btn-danger" id="stopBtn" disabled>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="6" y="6" width="12" height="12"></rect>
                </svg>
                Stop Recording
            </button>
            <button class="btn btn-light" id="saveWorkflowBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                    <polyline points="7 3 7 8 15 8"></polyline>
                </svg>
                Save Workflow
            </button>
            <button class="btn btn-light" id="loadWorkflowBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                Load Workflow
            </button>
        </div>
    </div>

    <!-- Main container with sidebar, workspace, and properties panel -->
    <div class="main-container">
        <!-- Component sidebar -->
        <div class="sidebar">
            <div class="sidebar-tabs">
                <div class="sidebar-tab active" data-tab="components">Components</div>
                <div class="sidebar-tab" data-tab="recorded">Recorded Actions</div>
            </div>
            <div class="sidebar-content" id="componentsTab">
                <!-- Action components -->
                <div class="component-group">
                    <div class="component-group-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="9 11 12 14 22 4"></polyline>
                            <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                        </svg>
                        Actions
                    </div>
                    <div class="component-list">
                        <div class="component-item action" draggable="true" data-component-type="shell">
                            <div class="component-item-icon action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="4 17 10 11 4 5"></polyline>
                                    <line x1="12" y1="19" x2="20" y2="19"></line>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Shell Command</div>
                                <div class="component-item-description">Execute shell commands</div>
                            </div>
                        </div>
                        <div class="component-item action" draggable="true" data-component-type="http">
                            <div class="component-item-icon action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="2" y1="12" x2="22" y2="12"></line>
                                    <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">HTTP Request</div>
                                <div class="component-item-description">Make API calls</div>
                            </div>
                        </div>
                        <div class="component-item action" draggable="true" data-component-type="browser">
                            <div class="component-item-icon action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                                    <polyline points="21 15 16 10 5 21"></polyline>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Browser Action</div>
                                <div class="component-item-description">Automate web interactions</div>
                            </div>
                        </div>
                        <div class="component-item action" draggable="true" data-component-type="desktop">
                            <div class="component-item-icon action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                    <line x1="8" y1="21" x2="16" y2="21"></line>
                                    <line x1="12" y1="17" x2="12" y2="21"></line>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Desktop Action</div>
                                <div class="component-item-description">Control desktop applications</div>
                            </div>
                        </div>
                        <div class="component-item action" draggable="true" data-component-type="llm">
                            <div class="component-item-icon action">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">LLM Prompt</div>
                                <div class="component-item-description">Generate content with AI</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Decision components -->
                <div class="component-group">
                    <div class="component-group-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                        </svg>
                        Decisions & Flow
                    </div>
                    <div class="component-list">
                        <div class="component-item decision" draggable="true" data-component-type="decision">
                            <div class="component-item-icon decision">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M16 3h5v5"></path>
                                    <path d="M8 3H3v5"></path>
                                    <path d="M3 16v5h5"></path>
                                    <path d="M16 21h5v-5"></path>
                                    <rect x="10" y="10" width="4" height="4"></rect>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Decision</div>
                                <div class="component-item-description">Conditional branching</div>
                            </div>
                        </div>
                        <div class="component-item approval" draggable="true" data-component-type="approval">
                            <div class="component-item-icon approval">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"></path>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Approval</div>
                                <div class="component-item-description">Human-in-the-loop approval</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trigger components -->
                <div class="component-group">
                    <div class="component-group-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polygon points="10 8 16 12 10 16 10 8"></polygon>
                        </svg>
                        Triggers
                    </div>
                    <div class="component-list">
                        <div class="component-item trigger" draggable="true" data-component-type="schedule">
                            <div class="component-item-icon trigger">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <polyline points="12 6 12 12 16 14"></polyline>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Schedule</div>
                                <div class="component-item-description">Run on a schedule</div>
                            </div>
                        </div>
                        <div class="component-item trigger" draggable="true" data-component-type="webhook">
                            <div class="component-item-icon trigger">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                    <polyline points="15 3 21 3 21 9"></polyline>
                                    <line x1="10" y1="14" x2="21" y2="3"></line>
                                </svg>
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">Webhook</div>
                                <div class="component-item-description">Trigger via HTTP request</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="sidebar-content" id="recordedTab" style="display: none;">
                <div id="recordedActionsList">
                    <p>No recorded actions yet. Start recording to capture actions.</p>
                </div>
            </div>
        </div>

        <!-- Workspace with canvas -->
        <div class="workspace">
            <div class="workspace-toolbar">
                <button class="btn btn-light" id="undoBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 7v6h6"></path>
                        <path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13"></path>
                    </svg>
                    Undo
                </button>
                <button class="btn btn-light" id="redoBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 7v6h-6"></path>
                        <path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3L21 13"></path>
                    </svg>
                    Redo
                </button>
                <button class="btn btn-light" id="deleteBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                    Delete
                </button>
                <button class="btn btn-light" id="clearBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 3h18v18H3z"></path>
                    </svg>
                    Clear All
                </button>
                <button class="btn btn-light" id="runWorkflowBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="5 3 19 12 5 21 5 3"></polygon>
                    </svg>
                    Run Workflow
                </button>
            </div>
            <div class="workspace-canvas" id="workspaceCanvas">
                <div class="canvas-container" id="canvasContainer">
                    <!-- Nodes and connections will be added here dynamically -->
                </div>
                <div class="zoom-controls">
                    <button class="zoom-btn" id="zoomOutBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            <line x1="8" y1="11" x2="14" y2="11"></line>
                        </svg>
                    </button>
                    <div class="zoom-level" id="zoomLevel">100%</div>
                    <button class="zoom-btn" id="zoomInBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                            <line x1="11" y1="8" x2="11" y2="14"></line>
                            <line x1="8" y1="11" x2="14" y2="11"></line>
                        </svg>
                    </button>
                    <button class="zoom-btn" id="zoomResetBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 2v6h-6"></path>
                            <path d="M3 12a9 9 0 0 1 15-6.7L21 8"></path>
                            <path d="M3 22v-6h6"></path>
                            <path d="M21 12a9 9 0 0 1-15 6.7L3 16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Properties panel -->
        <div class="properties-panel">
            <div class="properties-header">
                <div class="properties-title">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M20 14.66V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h5.34"></path>
                        <polygon points="18 2 22 6 12 16 8 16 8 12 18 2"></polygon>
                    </svg>
                    Properties
                </div>
                <button class="node-action-btn" id="closePropertiesBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                </button>
            </div>
            <div class="properties-content" id="propertiesContent">
                <p>Select a node to view and edit its properties.</p>
            </div>
        </div>
    </div>

    <!-- Status bar -->
    <div class="status-bar">
        <div class="status-item">
            <span id="nodeCount">0 nodes</span>
        </div>
        <div class="status-item">
            <span id="connectionCount">0 connections</span>
        </div>
        <div class="status-item">
            <span id="statusMessage">Ready</span>
        </div>
    </div>

    <!-- Recording preview -->
    <div class="recording-preview" id="recordingPreview">
        <div class="recording-preview-header">
            <div class="recording-preview-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
                Recording in Progress
            </div>
            <button class="node-action-btn" id="minimizePreviewBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
            </button>
        </div>
        <div class="recording-preview-content">
            <div class="recording-preview-screen" id="previewScreen">
                Screen preview not available
            </div>
            <div class="recording-preview-actions">
                <div class="recording-time" id="recordingTime">00:00</div>
                <button class="btn btn-danger btn-sm" id="previewStopBtn">Stop Recording</button>
            </div>
        </div>
    </div>

    <!-- Save workflow modal -->
    <div class="modal-overlay" id="saveWorkflowModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Save Workflow</div>
                <button class="modal-close" id="closeSaveModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="property-field">
                    <label class="property-label" for="workflowName">Workflow Name</label>
                    <input type="text" id="workflowName" class="property-input" placeholder="Enter workflow name">
                </div>
                <div class="property-field">
                    <label class="property-label" for="workflowDescription">Description</label>
                    <textarea id="workflowDescription" class="property-textarea" placeholder="Enter workflow description"></textarea>
                </div>
                <div class="property-field">
                    <label class="property-label" for="workflowTags">Tags (comma separated)</label>
                    <input type="text" id="workflowTags" class="property-input" placeholder="e.g., automation, data-processing">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-light" id="cancelSaveBtn">Cancel</button>
                <button class="btn btn-primary" id="confirmSaveBtn">Save Workflow</button>
            </div>
        </div>
    </div>

    <!-- Load workflow modal -->
    <div class="modal-overlay" id="loadWorkflowModal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">Load Workflow</div>
                <button class="modal-close" id="closeLoadModalBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="property-field">
                    <label class="property-label" for="workflowSelect">Select Workflow</label>
                    <select id="workflowSelect" class="property-select">
                        <option value="">-- Select a workflow --</option>
                        <!-- Workflows will be populated dynamically -->
                    </select>
                </div>
                <div id="workflowDetails" style="margin-top: 1rem; display: none;">
                    <div style="font-weight: 500; margin-bottom: 0.5rem;">Workflow Details</div>
                    <div id="selectedWorkflowDetails" style="background-color: #f5f7fa; padding: 1rem; border-radius: 4px; font-size: 0.9rem;">
                        <!-- Workflow details will be shown here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-light" id="cancelLoadBtn">Cancel</button>
                <button class="btn btn-primary" id="confirmLoadBtn">Load Workflow</button>
            </div>
        </div>
    </div>

    <!-- Toast container -->
    <div class="toast-container" id="toastContainer">
        <!-- Toasts will be added here dynamically -->
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM elements
            const recordBtn = document.getElementById('recordBtn');
            const stopBtn = document.getElementById('stopBtn');
            const recordingIndicator = document.getElementById('recordingIndicator');
            const recordingDot = document.getElementById('recordingDot');
            const recordingStatus = document.getElementById('recordingStatus');
            const recordingPreview = document.getElementById('recordingPreview');
            const previewStopBtn = document.getElementById('previewStopBtn');
            const minimizePreviewBtn = document.getElementById('minimizePreviewBtn');
            const recordingTime = document.getElementById('recordingTime');
            const componentsTab = document.getElementById('componentsTab');
            const recordedTab = document.getElementById('recordedTab');
            const recordedActionsList = document.getElementById('recordedActionsList');
            const canvasContainer = document.getElementById('canvasContainer');
            const propertiesContent = document.getElementById('propertiesContent');
            const closePropertiesBtn = document.getElementById('closePropertiesBtn');
            const saveWorkflowBtn = document.getElementById('saveWorkflowBtn');
            const loadWorkflowBtn = document.getElementById('loadWorkflowBtn');
            const saveWorkflowModal = document.getElementById('saveWorkflowModal');
            const loadWorkflowModal = document.getElementById('loadWorkflowModal');
            const closeSaveModalBtn = document.getElementById('closeSaveModalBtn');
            const closeLoadModalBtn = document.getElementById('closeLoadModalBtn');
            const confirmSaveBtn = document.getElementById('confirmSaveBtn');
            const confirmLoadBtn = document.getElementById('confirmLoadBtn');
            const cancelSaveBtn = document.getElementById('cancelSaveBtn');
            const cancelLoadBtn = document.getElementById('cancelLoadBtn');
            const workflowName = document.getElementById('workflowName');
            const workflowDescription = document.getElementById('workflowDescription');
            const workflowTags = document.getElementById('workflowTags');
            const workflowSelect = document.getElementById('workflowSelect');
            const workflowDetails = document.getElementById('workflowDetails');
            const selectedWorkflowDetails = document.getElementById('selectedWorkflowDetails');
            const nodeCount = document.getElementById('nodeCount');
            const connectionCount = document.getElementById('connectionCount');
            const statusMessage = document.getElementById('statusMessage');
            const toastContainer = document.getElementById('toastContainer');
            const zoomInBtn = document.getElementById('zoomInBtn');
            const zoomOutBtn = document.getElementById('zoomOutBtn');
            const zoomResetBtn = document.getElementById('zoomResetBtn');
            const zoomLevel = document.getElementById('zoomLevel');
            const undoBtn = document.getElementById('undoBtn');
            const redoBtn = document.getElementById('redoBtn');
            const deleteBtn = document.getElementById('deleteBtn');
            const clearBtn = document.getElementById('clearBtn');
            const runWorkflowBtn = document.getElementById('runWorkflowBtn');

            // State variables
            let isRecording = false;
            let recordingStartTime = null;
            let recordingTimer = null;
            let recordedActions = [];
            let nodes = [];
            let connections = [];
            let selectedNode = null;
            let isDragging = false;
            let startConnectionPoint = null;
            let tempConnection = null;
            let undoStack = [];
            let redoStack = [];
            let zoom = 1;
            let pan = { x: 0, y: 0 };
            let lastMousePos = { x: 0, y: 0 };
            let isPanning = false;

            // Initialize the application
            function init() {
                setupEventListeners();
                updateNodeCount();
                updateConnectionCount();
                updateStatus('Ready');
                showToast('info', 'Welcome', 'AI Engine Workflow Recorder is ready');
            }

            // Set up event listeners
            function setupEventListeners() {
                // Recording controls
                recordBtn.addEventListener('click', startRecording);
                stopBtn.addEventListener('click', stopRecording);
                previewStopBtn.addEventListener('click', stopRecording);
                minimizePreviewBtn.addEventListener('click', toggleRecordingPreview);

                // Sidebar tabs
                document.querySelectorAll('.sidebar-tab').forEach(tab => {
                    tab.addEventListener('click', () => {
                        document.querySelectorAll('.sidebar-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                        const tabId = tab.getAttribute('data-tab');
                        if (tabId === 'components') {
                            componentsTab.style.display = 'block';
                            recordedTab.style.display = 'none';
                        } else {
                            componentsTab.style.display = 'none';
                            recordedTab.style.display = 'block';
                        }
                    });
                });

                // Draggable components
                document.querySelectorAll('.component-item').forEach(item => {
                    item.addEventListener('dragstart', handleDragStart);
                });

                // Canvas events
                canvasContainer.addEventListener('dragover', handleDragOver);
                canvasContainer.addEventListener('drop', handleDrop);
                canvasContainer.addEventListener('click', handleCanvasClick);
                canvasContainer.addEventListener('mousedown', handleCanvasMouseDown);
                canvasContainer.addEventListener('mousemove', handleCanvasMouseMove);
                canvasContainer.addEventListener('mouseup', handleCanvasMouseUp);

                // Properties panel
                closePropertiesBtn.addEventListener('click', closeProperties);

                // Modals
                saveWorkflowBtn.addEventListener('click', openSaveWorkflowModal);
                loadWorkflowBtn.addEventListener('click', openLoadWorkflowModal);
                closeSaveModalBtn.addEventListener('click', closeSaveWorkflowModal);
                closeLoadModalBtn.addEventListener('click', closeLoadWorkflowModal);
                confirmSaveBtn.addEventListener('click', saveWorkflow);
                confirmLoadBtn.addEventListener('click', loadWorkflow);
                cancelSaveBtn.addEventListener('click', closeSaveWorkflowModal);
                cancelLoadBtn.addEventListener('click', closeLoadWorkflowModal);
                workflowSelect.addEventListener('change', showSelectedWorkflowDetails);

                // Zoom controls
                zoomInBtn.addEventListener('click', zoomIn);
                zoomOutBtn.addEventListener('click', zoomOut);
                zoomResetBtn.addEventListener('click', resetZoom);
                canvasContainer.addEventListener('wheel', handleCanvasWheel);

                // Toolbar actions
                undoBtn.addEventListener('click', undo);
                redoBtn.addEventListener('click', redo);
                deleteBtn.addEventListener('click', deleteSelected);
                clearBtn.addEventListener('click', clearCanvas);
                runWorkflowBtn.addEventListener('click', runWorkflow);
            }

            // Recording functions
            function startRecording() {
                isRecording = true;
                recordingStartTime = new Date();
                recordingTimer = setInterval(updateRecordingTime, 1000);
                
                // Update UI
                recordBtn.disabled = true;
                stopBtn.disabled = false;
                recordingIndicator.classList.add('active');
                recordingDot.classList.add('active');
                recordingStatus.textContent = 'Recording';
                recordingPreview.classList.add('active');
                
                // Clear previous recorded actions
                recordedActions = [];
                updateRecordedActionsList();
                
                // Show toast
                showToast('success', 'Recording Started', 'Screen and actions are now being recorded');
                
                // Update status
                updateStatus('Recording in progress...');
                
                // Simulate recording (in a real implementation, this would call the backend API)
                simulateRecording();
            }

            function stopRecording() {
                if (!isRecording) return;
                
                isRecording = false;
                clearInterval(recordingTimer);
                
                // Update UI
                recordBtn.disabled = false;
                stopBtn.disabled = true;
                recordingIndicator.classList.remove('active');
                recordingDot.classList.remove('active');
                recordingStatus.textContent = 'Not Recording';
                recordingPreview.classList.remove('active');
                
                // Show toast
                showToast('info', 'Recording Stopped', `Recorded ${recordedActions.length} actions in ${formatTime(Math.floor((new Date() - recordingStartTime) / 1000))}`);
                
                // Update status
                updateStatus('Recording stopped. Processing actions...');
                
                // Process recorded actions
                processRecordedActions();
            }

            function updateRecordingTime() {
                if (!isRecording || !recordingStartTime) return;
                
                const elapsedSeconds = Math.floor((new Date() - recordingStartTime) / 1000);
                recordingTime.textContent = formatTime(elapsedSeconds);
            }

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const remainingSeconds = seconds % 60;
                return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
            }

            function toggleRecordingPreview() {
                recordingPreview.classList.toggle('minimized');
            }

            // Simulate recording (for demo purposes)
            function simulateRecording() {
                // This function simulates recording by adding random actions at intervals
                // In a real implementation, this would be replaced with actual recording logic
                
                const actionTypes = ['click', 'type', 'keypress', 'scroll', 'navigate'];
                const elements = ['button', 'input', 'link', 'dropdown', 'checkbox', 'window'];
                
                // Add a simulated action every 2-5 seconds
                const addAction = () => {
                    if (!isRecording) return;
                    
                    const actionType = actionTypes[Math.floor(Math.random() * actionTypes.length)];
                    const element = elements[Math.floor(Math.random() * elements.length)];
                    const timestamp = new Date();
                    
                    let actionDetails = {};
                    
                    switch (actionType) {
                        case 'click':
                            actionDetails = {
                                x: Math.floor(Math.random() * 1000),
                                y: Math.floor(Math.random() * 800),
                                element: element,
                                id: `${element}_${Math.floor(Math.random() * 100)}`
                            };
                            break;
                        case 'type':
                            actionDetails = {
                                text: 'Sample text input',
                                element: 'input',
                                id: `input_${Math.floor(Math.random() * 100)}`
                            };
                            break;
                        case 'keypress':
                            actionDetails = {
                                key: ['Enter', 'Tab', 'Escape', 'ArrowDown'][Math.floor(Math.random() * 4)],
                                element: element
                            };
                            break;
                        case 'scroll':
                            actionDetails = {
                                direction: ['up', 'down'][Math.floor(Math.random() * 2)],
                                amount: Math.floor(Math.random() * 500)
                            };
                            break;
                        case 'navigate':
                            actionDetails = {
                                url: 'https://example.com/' + Math.random().toString(36).substring(7),
                                title: 'Example Page'
                            };
                            break;
                    }
                    
                    const action = {
                        type: actionType,
                        timestamp: timestamp,
                        details: actionDetails
                    };
                    
                    recordedActions.push(action);
                    updateRecordedActionsList();
                    
                    // Schedule next action
                    if (isRecording) {
                        setTimeout(addAction, Math.random() * 3000 + 2000);
                    }
                };
                
                // Start adding actions
                setTimeout(addAction, 2000);
            }

            function updateRecordedActionsList() {
                if (recordedActions.length === 0) {
                    recordedActionsList.innerHTML = '<p>No recorded actions yet. Start recording to capture actions.</p>';
                    return;
                }
                
                let html = '<div class="component-group"><div class="component-group-title">Recorded Actions</div><div class="component-list">';
                
                recordedActions.forEach((action, index) => {
                    const time = action.timestamp.toTimeString().split(' ')[0];
                    let icon = '';
                    let title = '';
                    let description = '';
                    
                    switch (action.type) {
                        case 'click':
                            icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path><polyline points="10 17 15 12 10 7"></polyline><line x1="15" y1="12" x2="3" y2="12"></line></svg>';
                            title = 'Mouse Click';
                            description = `${action.details.element} at (${action.details.x}, ${action.details.y})`;
                            break;
                        case 'type':
                            icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.83 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>';
                            title = 'Text Input';
                            description = `"${action.details.text.substring(0, 15)}${action.details.text.length > 15 ? '...' : ''}"`;
                            break;
                        case 'keypress':
                            icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2" ry="2"></rect><path d="M6 8h.001"></path><path d="M10 8h.001"></path><path d="M14 8h.001"></path><path d="M18 8h.001"></path><path d="M8 12h.001"></path><path d="M12 12h.001"></path><path d="M16 12h.001"></path><path d="M7 16h10"></path></svg>';
                            title = 'Key Press';
                            description = `${action.details.key} on ${action.details.element}`;
                            break;
                        case 'scroll':
                            icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M2 12h20"></path></svg>';
                            title = 'Scroll';
                            description = `${action.details.direction} by ${action.details.amount}px`;
                            break;
                        case 'navigate':
                            icon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>';
                            title = 'Navigate';
                            description = action.details.url;
                            break;
                    }
                    
                    html += `
                        <div class="component-item action" draggable="true" data-recorded-action="${index}">
                            <div class="component-item-icon action">
                                ${icon}
                            </div>
                            <div class="component-item-content">
                                <div class="component-item-title">${title} <span style="color: #95a5a6; font-size: 0.8rem;">${time}</span></div>
                                <div class="component-item-description">${description}</div>
                            </div>
                        </div>
                    `;
                });
                
                html += '</div></div>';
                
                // Add "Create Workflow" button if there are actions
                html += `
                    <div style="margin-top: 1rem;">
                        <button class="btn btn-primary" style="width: 100%;" id="createWorkflowBtn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                <circle cx="8.5" cy="7" r="4"></circle>
                                <line x1="20" y1="8" x2="20" y2="14"></line>
                                <line x1="23" y1="11" x2="17" y2="11"></line>
                            </svg>
                            Create Workflow from Actions
                        </button>
                    </div>
                `;
                
                recordedActionsList.innerHTML = html;
                
                // Add event listener to the Create Workflow button
                const createWorkflowBtn = document.getElementById('createWorkflowBtn');
                if (createWorkflowBtn) {
                    createWorkflowBtn.addEventListener('click', createWorkflowFromActions);
                }
                
                // Add drag event listeners to recorded actions
                document.querySelectorAll('[data-recorded-action]').forEach(item => {
                    item.addEventListener('dragstart', handleRecordedActionDragStart);
                });
            }

            function processRecordedActions() {
                // In a real implementation, this would process the recorded actions
                // and convert them into a workflow
                
                // For demo purposes, we'll just show a toast and update the status
                setTimeout(() => {
                    updateStatus('Actions processed. Ready to create workflow.');
                    showToast('success', 'Actions Processed', 'Recorded actions are ready to be used in a workflow');
                }, 1500);
            }

            function createWorkflowFromActions() {
                // This function would create a workflow from recorded actions
                
                // For demo purposes, we'll create some nodes based on the recorded actions
                clearCanvas();
                
                let x = 100;
                let y = 100;
                let lastNodeId = null;
                
                recordedActions.forEach((action, index) => {
                    let type = '';
                    let params = {};
                    
                    switch (action.type) {
                        case 'click':
                            type = 'desktop';
                            params = {
                                action: 'click',
                                x: action.details.x,
                                y: action.details.y,
                                element: action.details.element
                            };
                            break;
                        case 'type':
                            type = 'desktop';
                            params = {
                                action: 'type',
                                text: action.details.text,
                                element: action.details.element
                            };
                            break;
                        case 'keypress':
                            type = 'desktop';
                            params = {
                                action: 'keypress',
                                key: action.details.key,
                                element: action.details.element
                            };
                            break;
                        case 'scroll':
                            type = 'desktop';
                            params = {
                                action: 'scroll',
                                direction: action.details.direction,
                                amount